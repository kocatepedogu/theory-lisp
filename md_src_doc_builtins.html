<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Theory Lisp: Builtin Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Theory Lisp
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_src_doc_builtins.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Builtin Functions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1"></a>
IO Functions</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
load</h2>
<p>'load' function executes the given source file. It searches the default library path, which is normally '/usr/local/lib/tlisp' unless an installation prefix different from '/usr/local' is given. Global variables created by the included file are available after running the load function.</p>
<p>Example: </p><div class="fragment"><div class="line">(load &quot;util.tl&quot;)</div>
<div class="line">(load &quot;automata.tl&quot;)</div>
</div><!-- fragment --><p>'load' takes a single string argument. The return value is always (void). An error is thrown if it fails to find the file.</p>
<p>There is also 'include' keyword which uses the same syntax, but it includes the contents of a file at parsing time instead of runtime so that macro definitions from the included file can be used. Unless you need to load a file whose name is determined at runtime, you should use include.</p>
<p>For both 'include' and 'load', the full path of the file must be given if it is not in the default library path. In the future it will also search local files, but this is currently not supported.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
display</h2>
<p>'display' is used to write string representations of objects into the standard output. It is variadic and takes at least one argument. The arguments can be of any type.</p>
<p>Example:</p>
<div class="fragment"><div class="line">(display &quot;some string&quot; 123)</div>
<div class="line">(display &quot;a&quot; &quot;b&quot;)</div>
</div><!-- fragment --><p>Output is:</p>
<div class="fragment"><div class="line">some string123ab</div>
</div><!-- fragment --><p>In the output, there is no space between the arguments, and a newline is not automatically appended at end. If a newline is needed, the library function 'println' can be used instead.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
getchar</h2>
<p>'getchar' is used to read a single character from the standard input. The returned value is an integer. It returns (void) when end of file occurs. An error is thrown in case of an IO error.</p>
<p>REPL example </p><div class="fragment"><div class="line">(getchar)</div>
<div class="line">a</div>
<div class="line">97</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md5"></a>
putchar</h2>
<p>putchar takes integers as arguments and writes them to the standard output. Each integer represents a single character. The return value is (void). An error is thrown in case of an IO error.</p>
<p>REPL example </p><div class="fragment"><div class="line">(putchar 97 0x20 98 0x20 99 0x20 100)</div>
<div class="line">a b c d</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md6"></a>
current-seconds</h2>
<p>current-seconds returns the Unix timestamp (in seconds).</p>
<p>REPL example </p><div class="fragment"><div class="line">(current-seconds)</div>
<div class="line">1650553525</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
Comparison Operators</h1>
<p>In Theory Lisp, the only kind of equality is whether two objects contain equivalent data, and it is tested using = predicate which can take any type as argument.</p>
<p>= predicate can take one or more arguments. When it takes a single argument, the result is vacuously true. If it takes more than one argument, it is true if and only if all arguments are equal to each other.</p>
<p>!= predicate is equivalent to first applying the = predicate and then negating the result. When it takes a single argument, the result is false. If it takes more than one argument, it is true if and only if at least one argument is different from others.</p>
<p><b>Equality of Numeric Types</b></p>
<p>In Theory Lisp there are 3 numeric types: integer, real and rational. In order for two numbers to be equal, they must be numerically the same. Exact type equality is not required. For example,</p>
<div class="fragment"><div class="line">(= 2 2.0)</div>
<div class="line">(= 2 (/ 4 2))</div>
<div class="line">(= 2.0 2)</div>
<div class="line">(= 2.0 (/ 4 2))</div>
<div class="line">(= (/ 4 2) 2)</div>
<div class="line">(= (/ 4 2) 2.0)</div>
</div><!-- fragment --><p>all yield #t even though they are stored as different types. Note that not all numbers are exactly representable in floating point, so testing equality of real numbers is usually prone to errors. For example,</p>
<div class="fragment"><div class="line">(= 9007199254740993.0 9007199254740992)</div>
</div><!-- fragment --><p>yields #t even though they are clearly different numbers. The reason for this result is that the first number 9007199254740993.0 is not exactly representable and becomes 9007199254740992.0 in the floating point representation.</p>
<p><b>Equality of Booleans</b></p>
<p>Two boolean values are equal if they have the same truth value.</p>
<div class="fragment"><div class="line">(= #f #f) ; yields #t</div>
<div class="line">(= #f #t) ; yields #f</div>
<div class="line">(= #t #f) ; yields #f</div>
<div class="line">(= #t #t) ; yields #t</div>
</div><!-- fragment --><p><b>Equality of null</b></p>
<p>Formally, there is only a single null instance, so all variables with null values are equal.</p>
<p><b>Equality of void</b></p>
<p>Formally, void denotes the lack of a return value. It should not be viewed as a value. For example, displaying the result of a define expression gives void because it does not a yield a value.</p>
<div class="fragment"><div class="line">(display (define x 3))</div>
<div class="line">(void)</div>
</div><!-- fragment --><p>However, it is still possible to use void as a value because of the way interpreter is designed. A void 'value' can be generated using the function 'void', and two void values always compare equal. The ability to use void as a value may get removed in the future.</p>
<div class="fragment"><div class="line">(= (void) (void)) ; yields #t</div>
</div><!-- fragment --><p><b>Equality of strings</b></p>
<p>Two strings are equal if they have the same length, and contain the same characters in the same order.</p>
<div class="fragment"><div class="line">(= &quot;abc&quot; &quot;abc&quot;) ; yields #t</div>
<div class="line">(= &quot;cba&quot; &quot;abc&quot;) ; yields #f</div>
</div><!-- fragment --><p><b>Equality of procedures</b></p>
<p>Comparing two procedures for equality always yields #f. There are no exceptions.</p>
<p><b>Equality of pairs</b></p>
<p>Two pairs are equal if and only if their first and second elements are equivalent, that is, (= A B) is true iff the following is true</p>
<div class="fragment"><div class="line">(and (= (car A) (car B)) (= (cdr A) (cdr B)))</div>
</div><!-- fragment --><p><b>Less than operator</b></p>
<p>Less than operator is only defined for numeric types: integers, reals and rationals. Using any other type as argument to the less than operator will throw an "unsupported operation" error. The precision problems of numerical equality are also relevant to the less than operator. Other comparison operators (&lt;=, &gt;, &gt;=) are defined in terms of the equality operator and the less than operator. &lt;, &lt;=, &gt; and &gt;= take exactly 2 arguments, and are not variadic.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
Type Predicates</h1>
<p>For each builtin type, there is a type predicate that tests whether a given value has the corresponding type. They all take a single argument and return #t or #f.</p>
<div class="fragment"><div class="line">null?</div>
<div class="line">void?</div>
<div class="line">boolean?</div>
<div class="line">integer?</div>
<div class="line">real?</div>
<div class="line">rational?</div>
<div class="line">number?</div>
<div class="line">string?</div>
<div class="line">pair?</div>
<div class="line">procedure?</div>
</div><!-- fragment --><p>The only ones that may be confusing are real?, rational? and integer?. These predicates check how the given values are stored in the memory. If a value is stored as a floating point, real? yields true. If a value is stored as a rational number, rational? yields true. Similarly, if a number is stored as a machine integer, integer? yields true. They do not check whether the values are real numbers, rational numbers and integers in the mathematical sense. For example, (integer? 1.0) and (rational? 2) are both false, even though they are mathematically true.</p>
<h1><a class="anchor" id="autotoc_md9"></a>
Arithmetic Operators</h1>
<p>'+' is a variadic function that takes 0 or more arguments.</p>
<div class="fragment"><div class="line">; If no arguments are given, result is 0.</div>
<div class="line">(+) ; yields 0</div>
<div class="line">; If a single argument is given, result is equal to that argument.</div>
<div class="line">(+ 42) ; yields 42</div>
<div class="line">; If 2 or more arguments are given, result is the sum of arguments.</div>
<div class="line">(+ 1 2 3 4) ; yields 10</div>
</div><!-- fragment --><p>'*' is a variadic function that takes 0 or more arguments.</p>
<div class="fragment"><div class="line">; If no arguments are given, result is 1.</div>
<div class="line">(*) ; yields 1</div>
<div class="line">; If a single argument is given, result is equal to that argument.</div>
<div class="line">(* 42) ; yields 42</div>
<div class="line">; If 2 or more arguments are given, result is the product of arguments.</div>
<div class="line">(* 1 2 3 4) ; yields 24</div>
</div><!-- fragment --><p>'-' is a variadic function that takes 1 or more arguments.</p>
<div class="fragment"><div class="line">; If a single argument is given, result is the additive inverse.</div>
<div class="line">(- 42) ; yields -42</div>
<div class="line">; If 2 or more arguments are given, all arguments after </div>
<div class="line">; the first argument are subtracted from the first argument</div>
<div class="line">(- 10 1 2 3) ; yields 4</div>
</div><!-- fragment --><p>'/' is a variadic function that takes 1 or more arguments.</p>
<div class="fragment"><div class="line">; If a single argument is given, result is the multiplicative inverse.</div>
<div class="line">(/ 42) ; yields 1/42</div>
<div class="line">; If 2 or more arguments are given, the first argument is divided</div>
<div class="line">; by all of the remaining arguments</div>
<div class="line">(/ 24 1 2 3) ; yields 4</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md10"></a>
Boolean Operators</h1>
<p>There are two versions of boolean conjunction and disjunction operators.</p>
<p>For AND operator, 'and' (a macro) is short-circuiting, and '&amp;' (builtin function) is not short-circuiting.</p>
<p>Similarly, for OR operator, 'or' (a macro) is short-circuiting and '|' (builtin function is not short circuiting)</p>
<p>Both versions are provided because when the evaluation of arguments is trivial, &amp; and | can be faster, but in case each argument takes a long time to evaluate, 'and' and 'or' are better.</p>
<p>'xor' is the builtin function for boolean XOR operation, and 'not' is the builtin functin for boolean NOT operation.</p>
<h1><a class="anchor" id="autotoc_md11"></a>
List Functions</h1>
<p>'cons' creates a pair of values.</p>
<div class="fragment"><div class="line">(cons 1 &quot;a&quot;)</div>
</div><!-- fragment --><p>'list' creates a linked list of values.</p>
<div class="fragment"><div class="line">(list 1 2 3)</div>
<div class="line">; yields (cons 1 (cons 2 (cons 3 null)))</div>
</div><!-- fragment --><p>'car' returns the first element of a pair, and 'cdr' returns the second element of a pair</p>
<div class="fragment"><div class="line">(car (cons 1 &quot;a&quot;))</div>
<div class="line">; yields 1</div>
<div class="line">(cdr (cons 1 &quot;a&quot;))</div>
<div class="line">; yields &quot;a&quot;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md12"></a>
String Functions</h1>
<p>Unlike most Lisp dialects, Theory Lisp source code is based on strings, not lists. All expressions and objects can be exactly represented as strings, and conversions between all types of objects and strings is possible. The following string functions frequently are needed, especially in macros.</p>
<h2><a class="anchor" id="autotoc_md13"></a>
strlen</h2>
<p>Returns the length of a string object.</p>
<div class="fragment"><div class="line">(strlen &quot;string value&quot;)</div>
<div class="line">; yields 12</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md14"></a>
strcat</h2>
<p>Concatenates given strings. The function takes zero or more arguments, and they can be of any type. Objects with types other than string are converted to their string representation before getting concatenated. The string representation of an object is guaranteed to yield the same object when used as argument to 'eval' function, including procedure objects. This is critical for macros to work.</p>
<p>Calling strcat without arguments yields empty string</p>
<div class="fragment"><div class="line">(strcat) ; yields &quot;&quot;</div>
</div><!-- fragment --><p>Calling strcat with a single argument yields the string representation of the argument. The string representation does not have to be exactly equal to the argument as long as using it in 'eval' produces the same object. For an argument that is already a string the result is always the same.</p>
<div class="fragment"><div class="line">&gt; (strcat (lambda (...) (+ (car va_args) (* %(va_args)))))</div>
<div class="line">&quot;(lambda\0 (...) (+ (car va_args) (* %(va_args))))&quot;</div>
</div><!-- fragment --><p>When strcat is called with more than one argument, it concatenates string representations of all arguments.</p>
<div class="fragment"><div class="line">(strcat 42 &quot;42&quot; 42)</div>
<div class="line">; yields &quot;424242&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md15"></a>
charat</h2>
<p>Returns the character at the given index. Usage: (charat str index)</p>
<div class="fragment"><div class="line">(charat &quot;string value&quot; 4) ; yields &quot;n&quot;</div>
</div><!-- fragment --><p>There is no character type, so the result will be a string with a single character.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
substr</h2>
<p>Returns substring of a string. Usage: (substr str begin end) 'begin' index is included, 'end' is excluded.</p>
<div class="fragment"><div class="line">(substr &quot;string value&quot; 2 5) ; yields &quot;rin&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md17"></a>
strcar</h2>
<p>Returns the first character of the given string.</p>
<div class="fragment"><div class="line">(substr &quot;string value&quot;) ; yields &quot;s&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md18"></a>
strcdr</h2>
<p>Returns all characters except the first character.</p>
<div class="fragment"><div class="line">(substr &quot;string value&quot;) ; yields &quot;tring value&quot;</div>
</div><!-- fragment --><p>Names are choosen to be similar to 'car' and 'cdr'.</p>
<h2><a class="anchor" id="autotoc_md19"></a>
Special Characters</h2>
<p>'newline', 'tab', 'backspace', 'quotation-mark' are functions with zero arguments. They yield "\n", "\t", "\b", "\"" respectively. Escape characters are not allowed inside string literals. They may get included in the future.</p>
<h2><a class="anchor" id="autotoc_md20"></a>
i2s and s2i</h2>
<p>In case ASCII characters different from the previous ones are required, 'i2s' and 's2i' can be used to make conversions between integers and characters.</p>
<p>i2s takes zero or more integer arguments and converts them to a string. Values outside of the ASCII range are not allowed. Also, 0 cannot be used.</p>
<div class="fragment"><div class="line">&gt; (i2s 0x6c 0x69 0x73 0x70)</div>
<div class="line">&quot;lisp&quot;</div>
</div><!-- fragment --><p>s2i takes a string and returns a list of integers.</p>
<div class="fragment"><div class="line">&gt; (s2i &quot;lisp&quot;)</div>
<div class="line">(cons 108 (cons 105 (cons 115 (cons 112 null))))</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md21"></a>
Reflection</h1>
<h2><a class="anchor" id="autotoc_md22"></a>
eval</h2>
<p>'eval' is used to run code generated at runtime. It takes a single string argument and returns the value obtained from evaluating the expression contained in the string. All language features including macros are available inside 'eval'.</p>
<div class="fragment"><div class="line">(eval &quot;(+ 2 (* 3 4))&quot;)</div>
<div class="line">; yields 14</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md23"></a>
defined?</h2>
<p>Returns true if the given variable has been defined either locally or in any outer scope.</p>
<div class="fragment"><div class="line">(define x 42)</div>
<div class="line">(defined? &quot;x&quot;) ; yields #t</div>
<div class="line">(defined? &quot;y&quot;) ; yields #f</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md24"></a>
Exceptions</h1>
<h2><a class="anchor" id="autotoc_md25"></a>
exit</h2>
<p>Immediately stops the program. The interpreter does not enter into REPL when 'exit' is used. It is internally implemented with a specific type of error object, so it can be caught with a try-catch expression. This behaviour may get removed in the future.</p>
<div class="fragment"><div class="line">(exit)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md26"></a>
error</h2>
<p>Throws an error with the given error message. Errors can be caught using a try-catch expression. If an error is not handled, it propagates to the outermost scope and terminates the program with the given message. However, the interpeter still enters REPL after an error causes program to terminate, which can be used for debugging.</p>
<div class="fragment"><div class="line">(error &quot;error message&quot;)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md27"></a>
Math Functions</h1>
<p>The math functions are wrappers for C standard library functions. Available functions are cos, sin, tan, acos, asin, atan, atan2, cosh, sinh, tanh, acosh, asinh, atanh, exp, log, log10, pow, sqrt, cbrt, hypot, erf, erfc, tgamma, lgamma, ceil, floor, trunc, round, modulo, isfinite, isinf, inan, and isnormal. Their behaviour is unchanged.</p>
<p>The only math function that behaves differently is 'random', which generates a uniformly distributed real number in the interval [0, 1) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
